
<!DOCTYPE html>
<html>
<head>
<script th:src="@{/ckeditor/ckeditor.js}" type="text/javascript"></script>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Thêm bài viết mới</title>
<!-- BOOTSTRAP STYLES-->
<link th:href="@{/css/bootstrap.css}" rel="stylesheet" />
<!-- FONTAWESOME STYLES-->
<link th:href="@{/css/font-awesome.css}" rel="stylesheet" />
<!-- MORRIS CHART STYLES-->

<!-- CUSTOM STYLES-->
<link th:href="@{/css/custom.css}" rel="stylesheet" />
<!-- GOOGLE FONTS-->
<link th:href="@{http://fonts.googleapis.com/css?family=Open+Sans}"
	rel='stylesheet' type='text/css' />
<!-- TABLE STYLES-->
<link th:href="@{/js/dataTables/dataTables.bootstrap.css}"
	rel="stylesheet" />
</head>
<body>
	<div class="modal fade" id="notifyModal">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title">...</h4>
					<button type="button" class="close" data-dismiss="modal">&times;</button>
				</div>
				<div class="modal-body">...</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-danger" data-dismiss="modal">Đóng</button>
				</div>
			</div>
		</div>
	</div>
	<div id="wrapper">
		<div th:replace="/admin/nav-bar :: nav_bar"></div>
		<!-- /. NAV TOP  -->
		<div th:replace="/admin/slide-bar :: slide_bar"></div>
		<!-- /. NAV SIDE  -->
		<div id="page-wrapper">
			<div id="page-inner">
				<div class="row">
					<div class="col-md-12">
						<h2>Thêm bài viết mới</h2>

					</div>
				</div>
				<!-- /. ROW  -->
				<hr />
				<div class="row">
					<div class="col-md-12">
						<!-- Form Elements -->
						<div class="panel panel-default">
							<div class="panel-heading">Thêm bài viết mới</div>
							<div class="panel-body">
								<div class="row">
									<div class="col-md-6">
										<h3>Thông tin bài viết:</h3>

										<form role="form" id="form" th:action="@{/admin/news/insert}"
											method="post" enctype="multipart/form-data"
											th:object="${news}">
											<div class="form-group">
												<label>Loại bài viết:</label> <select
													th:field="*{category.id}" id="category">
													<option class="form-control" th:each="cat: ${categoryList}"
														th:value="${cat.id}" th:text="${cat.categoryName}"></option>
												</select>
											</div>
											<div class="form-group">
												<label>Tiêu đề bài viết:</label> <input class="form-control"
													placeholder="Tiêu đề bài viết" name="title" id="title"
													 required=""  oninvalid="this.setCustomValidity('Hãy nhập tiêu đề bài viết')" oninput="setCustomValidity('')" />
											</div>
											<div class="form-group">
												<label>Ảnh tiêu đề:</label> <input class="form-control"
													placeholder="Ảnh tiêu đề" name="imageFile" id="imageFile"
													type="file" accept="image/*"
													required=""  oninvalid="this.setCustomValidity('Hãy chọn ảnh cho bài viết')" oninput="setCustomValidity('')" />
											</div>
											<div class="form-group">
												<label>Người đăng:</label> <input class="form-control"												
													placeholder="Người đăng" name="poster" id="poster"
													required=""  oninvalid="this.setCustomValidity('Hãy nhập người đăng bài viết')" oninput="setCustomValidity('')" />
											</div>
											<div class="form-group">
												<label>Tác giả:</label> <input class="form-control"
													placeholder="Tác giả" name="author" id="author"
													required=""  oninvalid="this.setCustomValidity('Hãy nhập tác giả bài viết')" oninput="setCustomValidity('')" />
											</div>
<!-- 											<div class="form-group">
												<label>Ảnh</label> <input class="form-control"
													placeholder="Ảnh" name="image" id="image" />
											</div> -->
											<div class="form-group ">
												<label>Nội dung ngắn:</label> <input class="form-control"
													placeholder="Nội dung tiêu biểu" id="shortDescription"
													name="shortDescription"
													required=""  oninvalid="this.setCustomValidity('Hãy nhập nội dung ngắn cho bài viết')" oninput="setCustomValidity('')" />
											</div>
											<div class="form-group">
												<label>Nội dung chi tiết:</label>
												<textarea class="ckeditor"  rows="4" cols="50"
													name="detailDescription" id="detailDescription"
													required=""  oninvalid="this.setCustomValidity('Hãy nhập nội dung chi tiết cho bài viết')" oninput="setCustomValidity('')"></textarea>
											</div>
											<div class="form-group">
												<label>Nguồn:</label> <input class="form-control"
													placeholder="Nguồn" name="source" id="source"
													required=""  oninvalid="this.setCustomValidity('Hãy nhập nguồn')" oninput="setCustomValidity('')" />
											</div>
											<div class="form-group">
												<label>Hashtag:</label> <input class="form-control"
													placeholder="Hashatg" id="hashtag" name="hashtag"
													required=""  oninvalid="this.setCustomValidity('Hãy nhập hashtag cho bài viết')" oninput="setCustomValidity('')" />
											</div>
											<div class="form-group">
												<label>Trạng thái:</label> 
												<select id=status>
													<option value="1">Hoạt Động</option>
													<option value="0">Khoá</option>
												</select>
											</div>
											<div class="form-group">
												<label>Ngày sửa:</label> <input class="form-control"
													placeholder="Ngày sửa" id="modifiedDate"
													name="modifiedDate" />
											</div>
											<div class="form-group">
												<label>Ngày tạo:</label> <input class="form-control"
													placeholder="Ngày tạo"
													th:value="${#dates.format(#dates.createNow(), 'dd MMM')}"
													name="creationDate" id="creationDate" />
												<!-- dd MMM yyyy HH:mm  -->
											</div>


											<button type="submit" class="btn btn-default">Thêm
												bài viết</button>
											<button type="reset" class="btn btn-primary">Làm mới</button>
										</form>


									</div>
								</div>
							</div>
						</div>
						<!-- End Form Elements -->
					</div>
				</div>
				<!-- /. ROW  -->
				<div class="row">
					<div class="col-md-12"></div>
				</div>
				<!-- /. ROW  -->
			</div>
			<!-- /. PAGE INNER  -->
		</div>
		<!-- /. PAGE WRAPPER  -->
	</div>
	<!-- /. WRAPPER  -->
	<!-- SCRIPTS -AT THE BOTOM TO REDUCE THE LOAD TIME-->
	<!-- JQUERY SCRIPTS -->
	<script th:src="@{/js/jquery-1.10.2.js}"></script>
	<!-- BOOTSTRAP SCRIPTS -->
	<script th:src="@{/js/bootstrap.min.js}"></script>
	<!-- METISMENU SCRIPTS -->
	<script th:src="@{/js/jquery.metisMenu.js}"></script>
	<!-- DATA TABLE SCRIPTS -->
	<script th:src="@{/js/dataTables/jquery.dataTables.js}"></script>
	<script th:src="@{/js/dataTables/dataTables.bootstrap.js}"></script>
	<script>
		$(document).ready(function() {
			$('#dataTables-example').dataTable();
		});
		$("#form")
				.submit(
						function(e) {
							e.preventDefault();
							var category = $("#category").val();
							var title = $("#title").val();
							var imageFile = $('#imageFile')[0].files[0];
							var poster = $("#poster").val();
							var author = $("#author").val();
							var image = $("#image").val();
							var shortDescription = $("#shortDescription").val();
							var detailDescription = CKEDITOR.instances.detailDescription
									.getData()
							var source = $("#source").val();
							var hashtag = $("#hashtag").val();
							var status = $("#status").val();
							var modifiedDate = $("#modifiedDate").val();
							var creationDate = $("#creationDate").val();

							var form_data = new FormData();
							form_data.append('categoryId', category);
							form_data.append('title', title);
							form_data.append('imageFile', imageFile);
							form_data.append('poster', poster);
							form_data.append('author', author);
							form_data.append('image', image);
							form_data.append('shortDescription',
									shortDescription);
							form_data.append('source', source);
							form_data.append('hashtag', hashtag);
							form_data.append('status', status);
							form_data.append('modifiedDate', modifiedDate);
							form_data.append('creationDate', creationDate);
							form_data.append('detailDescription',
									detailDescription);

							console.log(123)
							$.ajax({
								url : document.location.origin
										+ "/admin/news/insert",
								type : 'POST',
								cache : false,
								processData : false,
								contentType : false,
								data : form_data,
								success : function() {
									notify("Thông báo",
											"Thêm bài viết thành công");
								},
								error : function() {
									notify("Lỗi", "Không thể xử lí dữ liệu");
								}
							});
							return false;
						});
		function notify(title, message) {
			$("#notifyModal .modal-title").html(title);
			$("#notifyModal .modal-body").html(message);
			$("#notifyModal").modal({
				backdrop : "static"
			});
		}
	</script>
	<!-- CUSTOM SCRIPTS -->
</body>
</html>